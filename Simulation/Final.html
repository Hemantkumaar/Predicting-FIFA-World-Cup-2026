<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FIFA 2026 Final</title>

<style>
body{
margin:0;
font-family:system-ui;
background:radial-gradient(circle at center,#111a33,#070b14);
color:white;
text-align:center;
overflow:hidden;
}

.container{
padding:60px 20px;
}

h1{
font-size:42px;
margin-bottom:40px;
}

.finalMatch{
background:rgba(18,28,51,.9);
padding:30px;
border-radius:20px;
border:1px solid rgba(255,255,255,.1);
max-width:700px;
margin:auto;
}

.teams{
display:flex;
justify-content:space-between;
gap:20px;
margin-bottom:20px;
}

.team{
flex:1;
padding:15px;
border-radius:12px;
background:rgba(255,255,255,.05);
font-size:20px;
font-weight:bold;
}

.predictBtn{
margin-top:20px;
padding:12px 24px;
background:#f6c453;
border:none;
border-radius:10px;
font-weight:bold;
font-size:16px;
cursor:pointer;
}

.countdown{
font-size:40px;
margin:20px 0;
color:#f6c453;
font-weight:bold;
}

.champion{
margin-top:30px;
font-size:28px;
font-weight:bold;
}

.trophy{
font-size:80px;
margin-top:20px;
animation:float 2s infinite ease-in-out;
}

@keyframes float{
0%{transform:translateY(0)}
50%{transform:translateY(-10px)}
100%{transform:translateY(0)}
}

canvas{
position:fixed;
top:0;
left:0;
pointer-events:none;
z-index:1000;
}

.resetBtn{
position:fixed;
bottom:30px;
right:30px;
padding:12px 20px;
border-radius:10px;
border:none;
background:#dc3545;
color:white;
font-weight:bold;
cursor:pointer;
}
</style>
</head>

<body>

<canvas id="confetti"></canvas>

<!-- champion song: add a file named 'champion.mp3' alongside this HTML or adjust path.
	Suggested track: "Waka Waka (This Time for Africa)" by Shakira. -->
<audio id="championSong" src="champion.mp3" preload="auto"></audio>

<div class="container">
<h1>üèÜ FIFA 2026 FINAL</h1>

<div class="finalMatch" id="finalMatch"></div>

<div id="countdown" class="countdown"></div>
<div id="champion" class="champion"></div>
<div id="trophy" class="trophy"></div>
</div>

<button class="resetBtn" onclick="resetTournament()">Reset Tournament</button>

<script>

/* -------- LOAD SEMIFINAL WINNERS -------- */

let teams = JSON.parse(localStorage.getItem("semifinal_winners"));

if(!teams || teams.length !== 2){
alert("Complete Semifinals first!");
window.location.href="semifinals.html";
}

const finalDiv=document.getElementById("finalMatch");

finalDiv.innerHTML=`
<div class="teams">
<div class="team">${teams[0].name}</div>
<div class="team">${teams[1].name}</div>
</div>
<button class="predictBtn" onclick="predictFinal()">
Simulate Final (10,000 runs)
</button>
`;

/* -------- MONTE CARLO FINAL -------- */

function predictFinal(){

const team1=teams[0];
const team2=teams[1];

const SIM=10000;
let t1Wins=0, t2Wins=0;

for(let s=0;s<SIM;s++){
const total=team1.perf+team2.perf;
const prob=team1.perf/total;
if(Math.random()<prob) t1Wins++;
else t2Wins++;
}

const t1Prob=(t1Wins/SIM)*100;
const t2Prob=(t2Wins/SIM)*100;

const winner = t1Prob>t2Prob ? team1 : team2;

localStorage.setItem("champion", JSON.stringify(winner));

let t=5;
const countdown=document.getElementById("countdown");
const championDiv=document.getElementById("champion");
const trophy=document.getElementById("trophy");

countdown.textContent="5";

const timer=setInterval(()=>{
t--;
countdown.textContent=t;

	if(t<=0){
clearInterval(timer);
countdown.textContent="";

championDiv.innerHTML=`
üî• ${winner.name} WINS THE WORLD CUP! üî•<br><br>
${team1.name}: ${t1Prob.toFixed(2)}%<br>
${team2.name}: ${t2Prob.toFixed(2)}%
`;

		// show trophy and celebrate
		trophy.textContent="üèÜ";
		// play the champion song if available
		const song = document.getElementById("championSong");
		if(song){
			song.currentTime = 0;
			song.play().catch(()=>{});
		}
		startFireworks();
}

},1000);
}

/* -------- FIREWORKS CELEBRATION -------- */

let fireworkAnim;
let fwActive=false;

function startFireworks(){
	const canvas=document.getElementById("confetti");
	const ctx=canvas.getContext("2d");
	canvas.width=window.innerWidth;
	canvas.height=window.innerHeight;
	fwActive=true;
	let particles = [];

	function spawnFirework(){
		const x = Math.random()*canvas.width;
		const y = Math.random()*canvas.height*0.5;
		const count = 30 + Math.floor(Math.random()*30);
		for(let i=0;i<count;i++){
			const angle = Math.random()*Math.PI*2;
			const speed = Math.random()*4+1;
			particles.push({
				x,y,
				vx:Math.cos(angle)*speed,
				vy:Math.sin(angle)*speed,
				life:60 + Math.random()*30,
				color:`hsl(${Math.random()*360},100%,50%)`
			});
		}
	}

	function draw(){
		ctx.clearRect(0,0,canvas.width,canvas.height);
		particles.forEach((p,i)=>{
			ctx.globalAlpha = p.life/90;
			ctx.fillStyle=p.color;
			ctx.beginPath();
			ctx.arc(p.x,p.y,2,0,Math.PI*2);
			ctx.fill();
			p.x += p.vx;
			p.y += p.vy;
			p.life--;
			if(p.life<=0) particles.splice(i,1);
		});
		if(fwActive){
			if(Math.random()<0.08) spawnFirework();
			fireworkAnim = requestAnimationFrame(draw);
		}
	}
	draw();
}

function stopFireworks(){
	fwActive=false;
	cancelAnimationFrame(fireworkAnim);
}

/* -------- RESET -------- */

function resetTournament(){
	// wipe all stored results and return to the simulation start page
	localStorage.clear();
	// the first page of the flow is the main FIFA Simulation screen
	window.location.href="Fifa Simulation.html";
}

</script>

</body>
</html>